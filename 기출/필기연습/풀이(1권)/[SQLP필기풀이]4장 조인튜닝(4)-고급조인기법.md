# \[SQLPν•„κΈ°ν’€μ΄]4μ¥ μ΅°μΈνλ‹(4)-κ³ κΈ‰μ΅°μΈκΈ°λ²•

#### βοΈ 45λ² : μ΅°μΈνλ‹-κ³ κΈ‰μ΅°μΈκΈ°λ²•

**μ•„λ SOLμ— λ€ν• νλ‹ λ°©μ•μΌλ΅ κ°€μ¥ λ¶€μ μ ν• κ²ƒμ„ κ³ λ¥΄μ‹μ¤.**

```sql
[λ°μ΄ν„°]
μ§€μ  : 30κ°
νλ§¤λ‚΄μ—­ : μ›” ν‰κ·  3λ§ κ±΄

[μΈλ±μ¤ κµ¬μ„±]
μ§€μ _PK : μ§€μ μ½”λ“
νλ§¤λ‚΄μ—­_PK : νλ§¤μ§€μ μ½”λ“ + νλ§¤μ›”
νλ§¤λ‚΄μ—­_X1 : νλ§¤μ›”

[sql]
SELECT A, μ§€μ λ…, SUM(B. νλ§¤κΈμ•΅) νλ§¤κΈμ•΅
FROM μ§€μ  A, νλ§¤λ‚΄μ—­ B
WHERE A, μ§€μ μ½”λ“ = B.νλ§¤μ§€μ μ½”λ“
AND B. νλ§¤μ›” BETWEEN '202101' AND '202103'
GROUP BY B.νλ§¤μ§€μ μ½”λ“, A.μ§€μ λ…
ORDER BY 1,2 ;
```

![](https://velog.velcdn.com/images/yooha9621/post/790e9065-90b0-4d5d-a9b3-a4f3dfbecd2c/image.png)

1. **GROUP BYμ 'B.νλ§¤μ§€μ μ½”λ“'λ¥Ό 'A.μ§€μ μ½”λ“'λ΅ λ³€κ²½ν•λ‹¤.** π‘‰ β
2. **μ΅°μΈ μμ„λ¥Ό λ³€κ²½ν•λ‹¤.** π‘‰ β­•οΈ
3. **νλ§¤μ›” μ΅°κ±΄μ„ λ§μ΅±ν•λ” νλ§¤λ‚΄μ—­μ„ μ§€μ μ½”λ“λ΅ GROUP BY ν• ν›„ μ§€μ  ν…μ΄λΈ”κ³Ό μ΅°μΈν•λ„λ΅ SQLμ„ λ³€ν™ν•λ‹¤.** π‘‰ β­•οΈ
4. **ν•΄μ‹ μ΅°μΈμΌλ΅ μ λ„ν•λ‹¤.** π‘‰ β­•οΈ

**π‹ κΈ°μ¶ ν¬μΈνΈ**

1. **ν„μ¬ SQLμ κ°€μ¥ ν° λ¬Έμ μ μ€ κ°™μ€ μ§€μ μ½”λ“μ— λ€ν• λ°λ³µμ μΈ μ΅°μΈ μ•΅μ„Έμ¤κ°€ λ§λ‹¤λ” λ° μλ‹¤.**
2. **λ‹¤λ‰μ νλ§¤λ‚΄μ—­μ„ μ½μΌλ©΄μ„ μ‘μ€ μ§€μ  ν…μ΄λΈ”κ³Ό μ΅°μΈν•κΈ° λ•λ¬Έμ— μƒκΈ°λ” ν„μƒμ΄λ‹¤.**
3. **GROUP BYμ— 'B.νλ§¤μ§€μ μ½”λ“' κΈ°μ ν•λ“  'A.μ§€μ μ½”λ“'λ¥Ό κΈ°μ ν•λ“  μ„±λ¥κ³Όλ” λ¬΄κ΄€ν•λ‹¤.**

**π’ λ¬Έμ  ν•΄μ„¤**

1. **μ§€μ  ν…μ΄λΈ”μ„ λ¨Όμ € μ½μ€ ν›„ νλ§¤λ‚΄μ—­κ³Ό NL μ΅°μΈν•λ‹¤λ©΄, μ΅°μΈ μ•΅μ„Έμ¤λ¥Ό 30λ²μΌλ΅ μ¤„μΌ μ μλ‹¤. λ§μΉ¨ νλ§¤λ‚΄μ—­\_PK μΈλ±μ¤κ°€ νλ§¤μ§€μ μ½”λ“ + νλ§¤ κµ¬μ„±λΌ μμ–΄ μ„±λ¥ κ°μ„ μ΄ κ°€λ¥ν•λ‹¤ .**
2. **ν•΄μ‹ μ΅°μΈμΌλ΅ μ λ„ν•λ©΄ μ‘μ€ μ§€μ  ν…μ΄λΈ”λ΅ PGAμ— ν•΄μ‹λ§µμ„ λ§λ“¤μ–΄μ„ μ΅°μΈν•κ² λλ―€λ΅ SGA λ²„νΌ μΊμ‹λ¥Ό λ°λ³µν•΄μ„ νƒμƒ‰ν•λ” λΉ„ν¨μ¨μ„ μ κ±°ν•  μ μλ‹¤.**
3. **3λ² μ„ μ§€μ κ²½μ°μ™€ κ°™μ΄ SQLμ„ λ³€ν™ν•λ©΄, μ΅°μΈ μ•΅μ„Έμ¤λ¥Ό μ§€μ λ³„λ΅ ν• λ²μ”©λ§ ν•  μ μμ–΄ μ„±λ¥ κ°μ„ μ— ν° λ„μ›€μ΄ λλ‹¤. λ‹¨, μΈλΌμΈ λ·°κ°€ Merging λλ©΄ μΏΌλ¦¬κ°€ μ›λ ν•νƒλ΅ λμ•„κ°€λ―€λ΅ λ°λ“μ‹ μ‹¤ν–‰κ³„νμ„ ν™•μΈν•κ³ , ν•„μ”ν•λ‹¤λ©΄ NO\_MERGE ννΈλ΅ λ·° Mergingμ„ λ°©μ§€ν•΄ μ¤μ•Ό ν•λ‹¤.**

#### βοΈ 46λ² :

![](https://velog.velcdn.com/images/yooha9621/post/95143d6f-b1aa-4ef0-8767-fda3ef8d2059/image.png)

**μ•„λμ™€ κ°™μ΄ SQL νλ‹ν•μ€λ‹¤.κ°μ„  ν¨κ³Όκ°€ κ·Ήλ€ν™”λκΈ° μ„ν•΄ λ§μ΅±ν•΄μ•Ό ν•  μ „μ μ΅°κ±΄μ„ μ¬λ°”λ¥΄κ² λ‚μ—΄ν•μ‹μ¤.**

```sql
--[νλ‹ μ „ SQL]
select c. κ³ κ°λ²νΈ, min(c.κ³ κ°λ…) κ³ κ°λ… , sum(o.μ£Όλ¬ΈκΈμ•΅) μ£Όλ¬ΈκΈμ•΅
from μ£Όλ¬Έ o, κ³ κ° c
where o.μ£Όλ¬ΈμΌμ‹ > add_months(sysdate, -1)
and c.λ“±λ΅μ§€μ μ½”λ“ = 'KTG'
andc.κ³ κ°λ²νΈ = o.κ³ κ°λ²νΈ
group by o. κ³ κ°λ²νΈ ;

--[νλ‹ ν›„ SQL]
select c.κ³ κ°λ²νΈ, c.κ³ κ°λ…, o.μ£Όλ¬ΈκΈμ•΅
from (
  select κ³ κ°λ²νΈ, sum(μ£Όλ¬ΈκΈμ•΅) μ£Όλ¬ΈκΈμ•΅
  from μ£Όλ¬Έ
  where μ£Όλ¬ΈμΌμ‹ >= add_months(sysdate, -1)
  group by κ³ κ°λ²νΈ) o, κ³ κ° c
where c.κ³ κ°λ²νΈ = 0. κ³ κ°λ²νΈ
and c. λ“±λ΅μ§€μ μ½”λ“ = 'KTG'

[ μ„±λ¥ κ°μ„ μ„ μ„ν• μ „μ μ΅°κ±΄ ]
κ°€) κ³ κ°λ‹Ή ν•λ£¨ μ£Όλ¬Έ κ±΄μκ°€ λ§λ‹¤.
λ‚) κ³ κ°λ‹Ή ν•λ£¨ μ£Όλ¬Έ κ±΄μκ°€ μ λ‹¤.
λ‹¤) μ£Όλ¬ΈμΌμ‹ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°κ°€ λ§λ‹¤.
λΌ) μ£Όλ¬ΈμΌμ‹ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°κ°€ μ λ‹¤.
λ§) λ“±λ΅μ§€μ μ½”λ“ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°κ°€ λ§λ‹¤.
λ°”) λ“±λ΅μ§€μ μ½”λ“ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°κ°€ μ λ‹¤.	
```

1. **κ°€) κ³ κ°λ‹Ή ν•λ£¨ μ£Όλ¬Έ κ±΄μκ°€ λ§λ‹¤.** π‘‰ β­•οΈ
2. **λ‹¤) μ£Όλ¬ΈμΌμ‹ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°κ°€ λ§λ‹¤.** π‘‰ β­•οΈ
3. **λ§) λ“±λ΅μ§€μ μ½”λ“ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°κ°€ λ§λ‹¤.** π‘‰ β­•οΈ

**π‹ κΈ°μ¶ ν¬μΈνΈ**

1. **\[νλ‹ ν›„ SQL]μ μ„±λ¥ κ°μ„  ν¨κ³Όλ¥Ό κ·Ήλ€ν™”ν•λ ¤λ©΄, β‘  κ³ κ°λ‹Ή ν•λ£¨ μ£Όλ¬Έ κ±΄μκ°€ λ§μ•„μ•Ό ν•κ³ , β‘¦μ£Όλ¬ΈμΌμ‹ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°κ°€ λ§μ•„μ•Ό ν•λ©°, β‘Άλ“±λ΅μ§€μ μ½”λ“ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°λ„ λ§μ•„μ•Ό ν•λ‹¤.**
2. **μ†μμ κ³ κ°μ΄ μ—¬λ¬ λ² λ°λ³µν•΄μ„ μ£Όλ¬Έν•λ” μ‡Όν•‘λ°μ΄λΌλ©΄ \[νλ‹ μ „ SQL]μ€ κ°™μ€ κ³ κ°μ— λ€ν•΄ μ—¬λ¬ λ² λ°λ³µν•΄μ„ κ³ κ° ν…μ΄λΈ”κ³Ό μ΅°μΈν•λ” λΉ„ν¨μ¨μ΄ λ‚νƒ€λ‚λ‹¤.**
3. **μ£Όλ¬ΈμΌμ‹ μ΅°κ±΄μ„ λ§μ΅±ν•λ” λ°μ΄ν„°κ°€ λ§μ„μλ΅ κ°™μ€ κ³ κ°μ΄ λ” μ—¬λ¬ λ² λ°λ³µν•΄μ„ λ‚νƒ€λ‚λ―€λ΅ λΉ„ν¨μ¨λ„ μ»¤μ§„λ‹¤.**
4. **\[νλ‹ ν›„ SQL] μ²λΌ κ³ κ°λ²νΈλ΅ GROUP BY ν• ν›„μ— μ΅°μΈν•λ©΄ κ³ κ°λ³„λ΅ ν• λ²μ”©λ§ μ΅°μΈν•  μ μμ–΄ μ„±λ¥ κ°μ„ μ— ν° λ„μ›€μ΄ λλ‹¤.**
5. \*\*λ‹¤μμ κ³ κ°μ΄ μ–΄μ©λ‹¤ ν•λ² μ£Όλ¬Έν•λ” μ‡Όν•‘λ°μ΄λΌλ©΄, \[νλ‹ ν›„ SQL]μ²λΌ κ³ κ°λ²νΈ λ΅ GROUP BY ν• ν›„μ— μ΅°μΈν–μ„ λ•μ μ΄μ μ΄ μ‚¬λΌμ§„λ‹¤.μ£Όλ¬ΈμΌμ‹ μ΅°κ±΄μ  κµ¬κ°„μ— κ°™μ€ κ³ κ°μ΄ μ—¬λ¬ λ² λ‚νƒ€λ‚μ§€ μ•κΈ° λ•λ¬Έμ΄λ‹¤. \*\*
6. **λ“±λ΅μ§€μ μ½”λ“ μ΅°κ±΄μ„ λ§μ΅±ν•λ” κ³ κ°μ΄ μ†μμΌ λ• \[νλ‹ ν›„ SQL]μ€ λ” λ¶λ¦¬ν•΄μ§„λ‹¤.ν• λ‹¬ μΉ μ£Όλ¬Έ λ°μ΄ν„°λ¥Ό λ¨λ‘ μ½μ–΄μ„ GROUP BY ν• ν›„μ— κ³ κ° ν…μ΄λΈ”κ³Ό μ΅°μΈν–λ”λ°, λ€λ¶€λ¶„ κ³ κ°μ΄ λ“±λ΅μ§€μ μ½”λ“ μ΅°κ±΄μ„ λ§μ΅±ν•μ§€ μ•μ•„ ν•„ν„°λ§ λκΈ° λ•λ¬Έμ΄λ‹¤.**
